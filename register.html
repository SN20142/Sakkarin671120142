<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£ - HR System</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/styles.css">
</head>
<body>

<div class="particles" aria-hidden="true"></div>

<!-- Particle control UI (on/off) -->
<div class="particle-controls" id="particleControls" role="region" aria-label="Particle Controls">
    <label style="display:flex;align-items:center;justify-content:space-between;gap:12px;">‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡∏Ñ‡∏•‡∏∑‡πà‡∏ô
        <span style="display:flex;align-items:center;gap:8px">
            <span class="small" style="opacity:0.85;margin-right:6px">‡∏õ‡∏¥‡∏î/‡πÄ‡∏õ‡∏¥‡∏î</span>
            <label class="switch">
                <input id="pc-enabled" type="checkbox" checked />
                <span class="slider"></span>
            </label>
        </span>
    </label>
</div>

<main class="wrapper">
    <section class="hero">
        <h1>‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£</h1>
        <p>‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô ‚Äî ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</p>
        <div style="margin-top:18px;display:flex;gap:10px;align-items:center">
            <div style="width:44px;height:44px;border-radius:10px;background:var(--glass);display:flex;align-items:center;justify-content:center">
                <!-- simple icon -->
                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 12c2.761 0 5-2.239 5-5s-2.239-5-5-5-5 2.239-5 5 2.239 5 5 5z" stroke="#60a5fa" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/><path d="M20 21v-1a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v1" stroke="#60a5fa" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </div>
            <div>
                <div style="font-weight:600;color:#e6eef8">HR Management</div>
                <div class="muted">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</div>
            </div>
        </div>
    </section>

    <aside class="card">
        <form id="registerForm" method="POST" onsubmit="return handleRegister(event)">
            <div class="section-title">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</div>
            <div class="row">
                <div class="col">
                    <label for="firstname">‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á <span style="color:#fca5a5">*</span></label>
                    <input id="firstname" name="firstname" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏°‡∏ä‡∏≤‡∏¢" required />
                </div>
                <div class="col">
                    <label for="lastname">‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• <span style="color:#fca5a5">*</span></label>
                    <input id="lastname" name="lastname" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÉ‡∏à‡∏î‡∏µ" required />
                </div>
            </div>

            <div class="row">
                <div class="col">
                    <label for="phone">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
                    <input id="phone" name="phone" type="tel" placeholder="08x-xxx-xxxx" />
                </div>
                <div class="col">
                    <label for="birthdate">‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î</label>
                    <input id="birthdate" name="birthdate" type="date" />
                </div>
            </div>

            <div class="section-title">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</div>
            <div class="row">
                <div class="col">
                    <label for="department">‡πÅ‡∏ú‡∏ô‡∏Å/‡∏ù‡πà‡∏≤‡∏¢ <span style="color:#fca5a5">*</span></label>
                    <select id="department" name="department" class="dept-select" required>
                        <option value="" disabled selected>üè¢ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å</option>
                        <option value="hr">üë• ‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• (HR)</option>
                        <option value="it">üíª ‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏® (IT)</option>
                        <option value="sales">üìà ‡∏ù‡πà‡∏≤‡∏¢‡∏Ç‡∏≤‡∏¢ (Sales)</option>
                        <option value="account">üí∞ ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô (Accounting)</option>
                        <option value="management">üéØ ‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£ (Management)</option>
                    </select>
                </div>
                <div class="col">
                    <label for="position">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</label>
                    <input id="position" name="position" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô Senior Developer" />
                </div>
            </div>

            <label for="emp_id">‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label>
            <input id="emp_id" name="emp_id" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô EMP-001" />

            <div class="section-title">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</div>
            <label for="email">‡∏≠‡∏µ‡πÄ‡∏°‡∏• (Email) <span style="color:#fca5a5">*</span></label>
            <input id="email" name="email" type="email" placeholder="name@company.com" required />

            <div class="row">
                <div class="col">
                    <label for="password">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô <span style="color:#fca5a5">*</span></label>
                    <input id="password" name="password" type="password" minlength="8" required />
                </div>
                <div class="col">
                    <label for="confirm_password">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô <span style="color:#fca5a5">*</span></label>
                    <input id="confirm_password" name="confirm_password" type="password" minlength="8" required />
                </div>
            </div>
            <div class="field-actions">
                <label style="display:flex;align-items:center;gap:8px;font-size:13px"><input type="checkbox" id="showPwd" /> ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label>
                <div style="margin-left:auto;font-size:13px;color:var(--muted)">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ 8 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£</div>
            </div>

            <div id="error" class="inline-note" style="display:none"></div>

            <div class="actions">
                <button type="submit" class="btn btn-primary">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                <a class="btn btn-link" href="login.html">‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</a>
            </div>

            <div class="footer-note">‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°? ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</div>
        </form>
    </aside>
</main>

<script>
// UX helpers
const showPwd = document.getElementById('showPwd');
showPwd.addEventListener('change', () => {
    const p = document.getElementById('password');
    const c = document.getElementById('confirm_password');
    const t = showPwd.checked ? 'text' : 'password';
    p.type = t; c.type = t;
});

function showError(msg){
    const el = document.getElementById('error');
    el.style.display = msg ? 'block' : 'none';
    el.textContent = msg || '';
}

async function handleRegister(event){
    event.preventDefault();
    showError('');

    const form = document.getElementById('registerForm');
    const fd = new FormData(form);

    // client-side validation
    const password = fd.get('password') || '';
    const confirm = fd.get('confirm_password') || '';
    const firstname = (fd.get('firstname')||'').trim();
    const lastname = (fd.get('lastname')||'').trim();
    const email = (fd.get('email')||'').trim();
    const department = (fd.get('department')||'').trim();

    if (!firstname || firstname.length < 2) return showError('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 2 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£');
    if (!lastname || lastname.length < 2) return showError('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 2 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£');
    if (!email || !/^\S+@\S+\.\S+$/.test(email)) return showError('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
    if (!department) return showError('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å');
    if (password.length < 8) return showError('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 8 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£');
    if (password !== confirm) return showError('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô');

    try {
        const res = await fetch('save_employee.php', { method: 'POST', body: fd });
        
        // ‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô Text ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤‡∏Å‡πà‡∏≠‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏≤‡∏°‡∏≤‡∏î‡∏π Error
        const rawResponse = await res.text();
        console.log("Server Response:", rawResponse); // << ‡∏î‡∏π‡∏Ñ‡πà‡∏≤‡∏ô‡∏µ‡πâ‡πÉ‡∏ô Console ‡∏Ç‡∏≠‡∏á Browser

        if (!res.ok) throw new Error('Network response was not ok');

        // ‡∏•‡∏≠‡∏á‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô JSON ‡∏ñ‡πâ‡∏≤‡∏ó‡∏≥‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏à‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤ Catch
        const data = JSON.parse(rawResponse); 

        if (data.status === 'success') {
            alert(data.message);
            form.reset();
            window.location.href = 'login.html';
        } else {
            showError(data.message || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î');
        }
    } catch (err) {
        console.error("Error details:", err);
        // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡πà‡∏≤ JSON ‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡∏ñ‡πâ‡∏≤ parse ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô
        showError('‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà JSON) ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏î‡∏π Console');
    }
    return false;
}
</script>
<script src="assets/particles.js"></script>
<script>
// Wire particle on/off switch to runtime API
function initParticleControls(){
    const ctrl = window.PARTICLE_CONTROL;
    if(!ctrl) return;
    const enabledEl = document.getElementById('pc-enabled');

    // initialize state
    try{
        const cfg = ctrl.getConfig ? ctrl.getConfig() : null;
        if(cfg && typeof enabledEl !== 'undefined' && enabledEl !== null){
            // default: enabled (if particles exist)
            enabledEl.checked = true;
        }
    } catch(e){ /* ignore */ }

    if(enabledEl){
        enabledEl.addEventListener('change', ()=>{
            const on = !!enabledEl.checked;
            if(ctrl.enable) ctrl.enable(on);
        });
    }
}

if(window.PARTICLE_CONTROL){ initParticleControls(); } else {
    window.addEventListener('DOMContentLoaded', ()=>{ setTimeout(initParticleControls, 120); });
    window.addEventListener('load', ()=>{ setTimeout(initParticleControls, 120); });
}
</script>
</body>
</html>